# –ü–î–î –ò—Å–ø–∞–Ω–∏–∏ - Flashcard App

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è –ò—Å–ø–∞–Ω–∏–∏ —Å –ø–æ–º–æ—â—å—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **6 —Ä–µ–∂–∏–º–æ–≤ –æ–±—É—á–µ–Ω–∏—è:**
  - üìã –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π ‚Äî –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É
  - üîÄ –°–ª—É—á–∞–π–Ω—ã–π ‚Äî –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ —Å–ª—É—á–∞–π–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
  - ‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ (–ø–æ –ø–æ—Ä—è–¥–∫—É) ‚Äî —Ç–æ–ª—å–∫–æ —Å–ª–æ–∂–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
  - ‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ (—Å–ª—É—á–∞–π–Ω–æ) ‚Äî —Å–ª–æ–∂–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–ª—É—á–∞–π–Ω–æ
  - üìù –≠–∫–∑–∞–º–µ–Ω ‚Äî 20 —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
  - üéß –ê—É–¥–∏–æ —Ä–µ–∂–∏–º ‚Äî –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–æ –æ–¥–Ω–æ–π –∏–ª–∏ –ø–æ–¥—Ä—è–¥

- **Tinder-like –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** ‚Äî —Å–≤–∞–π–ø –≤–ª–µ–≤–æ (–Ω–µ –∑–Ω–∞—é) / –≤–ø—Ä–∞–≤–æ (–∑–Ω–∞—é)
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
- **Telegram Mini App** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤–µ–±-—Å–∞–π—Ç –∏ –≤ Telegram

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd vodila

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å .env.example –≤ .env –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
cp .env.example .env

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose down
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ Docker –∞—É–¥–∏–æ –±–µ—Ä—ë—Ç—Å—è –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ `vodila/audio` (—Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞–∫ `/app/vodila/audio`).

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
docker compose logs -f
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞

```bash
docker compose build --no-cache
docker compose up -d
```

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### Backend + Frontend (production)

```bash
cd vodila/vodila
uv run uvicorn main:app --host 0.0.0.0 --port 8000
```

### Frontend (development)

```bash
cd frontend
npm run dev
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ frontend

```bash
cd frontend
npm run build
```

## API Endpoints

- `GET /api/modes` ‚Äî —Å–ø–∏—Å–æ–∫ —Ä–µ–∂–∏–º–æ–≤ –æ–±—É—á–µ–Ω–∏—è
- `GET /api/cards?mode=<mode>` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è —Ä–µ–∂–∏–º–∞
- `GET /api/progress` ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Telegram-User`)
- `POST /api/progress` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Telegram-User`)
- `GET /api/stats` ‚Äî –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- `GET /api/audio/cards` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç–æ—á–µ–∫ —Å URL –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ –æ–∑–≤—É—á–∫–∞ —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞)
- `POST /api/auth/telegram` ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram WebApp
- `GET /api/telegram/bot-info` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Telegram –±–æ—Ç–µ

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram WebApp –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

1. –í Telegram: –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `initDataUnsafe.user`
2. –í–Ω–µ Telegram: —Ä–µ–∂–∏–º –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ü—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ

–ó–∞–≥–æ–ª–æ–≤–æ–∫ `X-Telegram-User` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```json
{"id": "123456789", "username": "username"}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
vodila/
‚îú‚îÄ‚îÄ source_data/          # RTF —Ñ–∞–π–ª—ã —Å –¥–∞–Ω–Ω—ã–º–∏
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ generate_gemini_audio.py  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—É–¥–∏–æ –∫–∞—Ä—Ç–æ—á–µ–∫ —á–µ—Ä–µ–∑ Gemini
‚îú‚îÄ‚îÄ vodila/
‚îÇ   ‚îú‚îÄ‚îÄ main.py           # FastAPI backend
‚îÇ   ‚îú‚îÄ‚îÄ parser.py         # –ü–∞—Ä—Å–µ—Ä RTF —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ rules.db          # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ audio/            # –û–∑–≤—É—á–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ (wav)
‚îÇ   ‚îî‚îÄ‚îÄ static/           # –°–æ–±—Ä–∞–Ω–Ω—ã–π frontend
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.jsx       # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.css       # –°—Ç–∏–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.jsx      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.js    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vite
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ README.md
```

## Telegram Mini App

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Telegram:

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. –°–æ–∑–¥–∞–π—Ç–µ Mini App –∫–æ–º–∞–Ω–¥–æ–π `/newapp`
3. –£–∫–∞–∂–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, https://your-domain.com)
4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Å—Ä–µ–¥—É Telegram –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook

```bash
# –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ webhook
curl -X POST "https://api.telegram.org/bot<YOUR_TOKEN>/setWebhook?url=https://your-domain.com/api/telegram/webhook"
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

- **–°–≤–∞–π–ø –≤–ª–µ–≤–æ** –∏–ª–∏ **‚Üê** ‚Äî –Ω–µ –∑–Ω–∞—é
- **–°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ** –∏–ª–∏ **‚Üí** ‚Äî –∑–Ω–∞—é
- **–ö–Ω–æ–ø–∫–∏** ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

## –î–µ–ø–ª–æ–π

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | - |
| `DATABASE_PATH` | –ü—É—Ç—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö | `/app/data/rules.db` |
| `AUDIO_PATH` | –ö–∞—Ç–∞–ª–æ–≥ –¥–ª—è –æ–∑–≤—É—á–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ | `/app/data/audio` |
| `GEMINI_API_KEY` | API –∫–ª—é—á Gemini –¥–ª—è TTS | - |
| `GEMINI_TTS_MODEL` | –ú–æ–¥–µ–ª—å Gemini –¥–ª—è –æ–∑–≤—É—á–∫–∏ | `gemini-2.5-flash-preview-tts` |
| `GEMINI_TTS_VOICE` | –ì–æ–ª–æ—Å Gemini | `Kore` |
| `PYTHONPATH` | Python path | `/app` |
| `PORT` | –ü–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | `8000` |

### Docker Compose (production)

```yaml
services:
  app:
    image: your-registry/vodila-app:latest
    ports:
      - "8000:8000"
    volumes:
      - app_data:/app/data
    env_file:
      - .env
    restart: unless-stopped

volumes:
  app_data:
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è production

```bash
TELEGRAM_BOT_TOKEN=your_bot_token
DATABASE_PATH=/app/data/rules.db
```

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—É–¥–∏–æ –∫–∞—Ä—Ç–æ—á–µ–∫ (Gemini)

–ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î –º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–∑–≤—É—á–∫—É:

```bash
python3 scripts/generate_gemini_audio.py --api-key "$GEMINI_API_KEY" --only-missing
```

–ü–æ–ª–µ–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- `--text-field russian|spanish|both` ‚Äî –∫–∞–∫–æ–π —Ç–µ–∫—Å—Ç –æ–∑–≤—É—á–∏–≤–∞—Ç—å
- `--start-id` / `--end-id` ‚Äî –¥–∏–∞–ø–∞–∑–æ–Ω –∫–∞—Ä—Ç–æ—á–µ–∫
- `--force` ‚Äî –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã
- `--voice` / `--model` ‚Äî –≤—ã–±—Ä–∞—Ç—å –≥–æ–ª–æ—Å –∏ –º–æ–¥–µ–ª—å Gemini
